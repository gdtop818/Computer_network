#  应用层

通信服务如何提供给应用进程来使用，应用进程**通过什么样的应用层协议来使用网络所提供的这些通信服务**。通过位于不同主机中的多个应用进程之间的通信和协同工作来完成。**客户是服务请求发，服务器是服务提供方**。

（1）**域名系统DNS——从域名解析IP地址**

（2）**万维网和HTTP协议**，以及万维网的两种不同信息搜索引擎

（3）电子邮件传输过程，SMTP协议和POP3协议、IMAP协议使用的场合

（4）动态主机配置协议DHCP特点

（5）网络管理的三个组成部分：SNMP、SMI、MIB

（6）系统调用和源域编程接口概念

（7）P2P文件系统



**域名系统DNS**：**互联网使用的命名系统**；用户与主机通信时很难记住IP**32位**主机地址，DNS将互联网**主机名转为IP地址**；DNS是**分布式系统**，基本上大多数名字都在本地解析，运行域名服务器程序叫做域名服务器，域名到IP地址的解析由**分布在互联网上的许多域名服务器共同完成**；

**每一个标号不超过63个字符；不区分大小写；多个标号组成完整域名不超过255个字符；**

域名三大类：国家顶级域名nTLD、通用顶级域名gTLD、基础结构域名（反向域名，用于反向域名解析）

com net org int edu gov mil

域名服务器：每一个服务器负责的范围叫区；每个区设置权限域名服务器，一个区的结点都能连通；区是域的子集；

（1）根域名服务器（13个域名）：最高层次，最重要，知道所有顶级域名服务器的域名和IP地址；采取任播技术（不同地点的主机IP地址相同），用户请求时，IP数据报交付给离源最近的一台主机；

（2）顶级域名服务器TLD：在该顶级域名服务器下注册二级域名；

（3）权限域名服务器：负责一个区的域名服务器

（4）本地域名服务器：当一台主机发出DNS查询请求时，这个查询请求报文发送给本地域名服务器，主域名服务器和辅助域名服务器；



**域名到IP地址解析过程**：当某一进程需要把主机名解析为IP地址时，**调用解析程序**，成为DNS的一个客户，**把待解析的域名放在DNS的请求报文中**，以**UDP用户数据报方式发送给本地域名服务**器，本地域名服务器在**查找域名**后，把对应的**IP地址放在回答报文**中返回；

域名解析过程中域名查询的两种方式：本地域名服务器、根域名服务器、顶级域名服务器、权限域名服务器

（1）**主机向本地域名服务器**查询采用**递归查询（踢皮球）**；如果主机所询问的本地域名服务器不知道被查询的域名IP地址，那么本地域名服务器以DNS客户身份向其他根域名服务器发送查询请求报文；

（2）**本地域名服务器向根域名服务器**查询采用**迭代查询（追根溯源）**；根域名服务器收到本地域名服务器请求时，给出查询的IP地址或者告诉本地域名服务器下一步向哪一个域名服务器进行查询。然后本地域名服务器再进行后续查询。

为了**提高DNS查询效率**，**减轻根域名服务器的符合，减少DNS查询报文数量**，在**域名服务器采用高速缓存**；



**文件传送协议FTP**：提高交互式文件传送，允许客户指定文件格式和类型、存取权限。在异构网络之间任意传送文件；基于TCP可靠运输服务，FTP主要功能是减少或消除**不同操作系统下处理文件的不兼容性**；

FTP客户服务器：主进程（打开端口21，等待客户发出连接请求、处理请求后终止，回到等待状态，继续处理其他请求）、从属进程（和主进程并发进行，在处理完请求后终止）

**FTP文件传输时要建立两个TCP连接：控制连接（21）、数据连接（20）**



**简单文件传送协议TFTP**：使用UDP数据报，内存小，每次512字节（最后一次可不足512字节）、数据报文按标号传输、支持ASCII或二进制传送、可以读写、首部简单；

**远程终端协议TELNET**：用户可以通过TCP连接注册到远地的另一台主机上；



**万维网WWW**：大规模、联机式的信息储藏所；分布式的超媒体系统，是超文本系统地扩充；客户程序向服务器程序发出请求，服务器程序向客户程序送回客户所要的万维网文档；

**统一资源定位符URL**：标志万维网上的各种文档，每一个文档在互联网都有唯一标识符URL；

协议：// 主机：端口/路径

**超文本协议HTTP**：应用层协议，使用**TCP连接**进行可靠传送，**HTTP本身不需要建立连接**，**但是用户请求时HTTP协议先和服务器建立TCP连接**；每个万维网网点都有一个服务器进程，不断监听TCP端口80，发现是否有浏览器发送连接建立请求；一旦监听到请求并建立TCP连接后，浏览器向万维网服务器请求某个页面，服务器响应请求，然后TCP连接释放；请求和响应遵守HTTP协议；**HTTP是面向对象，面向文本的协议**。

​	http：// 主机：端口/路径

**请求一个万维网文档时间是两个RTT时间+传输文档时间**；万维网客户**发起TCP连接**，万维网服务器响应请求；万维网客户收到后发送**HTTP请求报文**，万维网服务器返回**HTTP响应报文**，并开始传输文档；

万维网高速缓存/**代理服务器**：

（1）计算机向互联网服务器请求时，**已经和代理服务器建立TCP连接**，并向代理服务器发送HTTP请求报文；

（2）若代理服务器已经存放该请求的对象，则直接把这个对象直接放入HTTP响应报文，并发给计算机浏览器；

（3）否则，代理服务器代表用户浏览器，向源点服务器建立TCP连接，发送HTTP请求报文；

（4）源点服务器把请求对象放在HTTP响应报文返回给代理服务器；

（5）代理服务器收到对象后**复制存储在本地存储器**，然后放在HTTP响应报文，通过与计算机已建立的TCP连接返回该请求到浏览器。



请求报文：请求行（方法、请求资源的URL、HTTP版本）、首部行、实体主体（通常不用）

响应报文：状态行、首部行、实体主体（有些响应报文不用）

​	状态码：1xx（通知消息）、2xx（成功）、3xx（重定向）、4xx（客户差错）、5xx（服务器差错）

Cookie存放用户信息，浏览器能跟踪用户在该网站活动；



电子邮件：简单邮件传送协议SMTP，邮件读取协议POP3（都使用TCP连接传送邮件）

SMTP：连接建立、邮件传送、连接适当

POP3和IMAP